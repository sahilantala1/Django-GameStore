{% extends 'base_a.html' %}
{% load static %}
{% block start %}
{% include 'navbar.html' %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<!-- Font Awesome 6 Free CDN (All styles) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-papAPcVdI1lDwNRO5nJYpKp94R6RbbOGRYnFJg5wFgCEkKvKHsm7PQ+Be2MYY8FXbwKOB0HT+M6RHV/hvZ2B7w==" crossorigin="anonymous" referrerpolicy="no-referrer" />

 <style>
      body {
        background: #000000;
      }
      .table-title {
        padding: 15px;
        background: #343a40;
        color: #fff;
        border-radius: 0.25rem 0.25rem 0 0;
      }
      .status-badge {
        font-size: 0.875em;
        padding: 0.3em 0.6em;
        border-radius: 0.25rem;
      }
      .status-active {
        background: #28a745;
        color: #fff;
      }
      .status-inactive {
        background: #6c757d;
        color: #fff;
      }
      .status-banned {
        background: #dc3545;
        color: #fff;
      }
      .status-pending {
        background: #0d6efd;
        color: #fff;
      }
      .status-suspended {
        background: #fd7e14;
        color: #fff;
      }
      .avatar {
        width: 32px;
        height: 32px;
        object-fit: cover;
        border-radius: 50%;
        margin-right: 0.5rem;
      }
    </style>
  <body>
    <div class="container my-4">
      <div
        class="table-title d-flex justify-content-between align-items-center"
      >
        <h4 class="mb-0">User Management</h4>
      </div>

     <form id="searchForm" class="row my-3">
  <div class="col-md-3">
    <input
      type="text"
      name="q"
      id="searchInput"
      value="{{ query|default:'' }}"
      class="form-control"
      placeholder="Search username or email..."
    />
  </div>
  <div class="col-md-2">
    <button type="submit" class="btn btn-primary">
      <i class="fa fa-search"></i> Search
    </button>
  </div>
</form>
     <div id="userTableContainer">
  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead class="table-dark">
        <tr>
          <th>No</th>
          <th>Username</th>
          <th>Email</th>
          <th>Actions</th>
        </tr>
      </thead>
        <tbody>
        {% for user in users %}
            <tr>
                <td>{{forloop.counter}}</td>
            <td>
                {{user.username | default:"-"}}
            </td>
                <td>{{user.email | default:"-"}}</td>
                <td>
                    <a href="{% url 'user_edit' user.id %}">Edit</i></a>
                    <a href="javascript:void(0);" onclick="confirmDelete({{user.id}})" >Delete</a>
                    <a href="#">More info</a>
                </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
  </div>
</div>
    </div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
  function confirmDelete(userId) {
    Swal.fire({
      title: 'Are you sure?',
      text: "This user will be deleted permanently!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#dc3545',
      cancelButtonColor: '#6c757d',
      confirmButtonText: 'Yes, delete it!',
      reverseButtons: true
    }).then((result) => {
      if (result.isConfirmed) {
        Swal.fire({
          title: 'Deleted!',
          text: "The user is being removed...",
          icon: 'success',
          showConfirmButton: false,
          timer: 2000,
          willClose: () => {
            window.location.href = `/manage_user/`;  // <-- Slash added
          }
        });
      }
    });
  }
</script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
